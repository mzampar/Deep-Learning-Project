# Convolutional LSTM Network for Precipitation Nowcasting

**Author:** Marco Zampar  
**Date:** 21/02/25  
**Repository:** [Deep Learning Project](https://github.com/mzampar/Deep-Learning-Project/tree/main)

---

## Problem Statement

The project aims to predict the development of storms through precipitation nowcasting, using sequences of radar images. The input sequences vary from 2 to 9 frames, with corresponding output sequences.

---

## Convolutional LSTM Network Architecture

### Inspired by "Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting"  
[Paper Link](https://arxiv.org/pdf/1506.04214)

- Utilizes Convolutional LSTM cells where inputs, hidden states, and context are passed through convolutions.
- Architecture includes an encoding network and a forecasting network, each stacked with multiple ConvLSTM layers.
- Final predictions generated by a 1 Ã— 1 convolutional layer after concatenating all forecasting network states.

---

## Convolutional Encoder-Decoder LSTM Network

### Custom Architecture Implementation

- Processes frames vertically, maintaining hidden and cell states across layers for efficiency.
- Uses sigmoid activation to constrain outputs to [0, 1].
- Encoder-decoder structure with configurable stride for convolutions to control image size.

---

## Hyperparameters

- **Architecture:** [64, 32, 32, 16]
- **Stride:** 1 | 2
- **Filter Size:** [3, 3, 3, 3]
- **Leaky ReLU Slope:** 0.2
- **Max Pooling:** True | False
- **Layer Normalization:** True | False
- **Loss Function:** BCELoss | SSIM | MSE
- **Batch Size:** 64
- **Number of Epochs:** 1
- **Scheduled Sampling:** True | False
- **Learning Rate Scheduler:** True | False
- **Bias in Convolutions:** True | False
- **Transposed Convolutions:** True | False
- **Use LSTM Output:** True | False
- **Initial Learning Rate:** 0.01
- **Learning Rate Gamma:** 0.95

---

## Learning Approach

- Implemented in PyTorch with fixed train-test split and validation set.
- Curriculum learning approach with increasing sequence lengths per epoch.
- Challenges observed due to LSTM's short memory span impacting loss reduction during training.

---

## Dataset: SRI (Surface Rainfall Intensity)

### Data Processing

- Images derived from Protezione Civile FVG's Fossalon Radar.
- Preprocessed: cropped, resized to grayscale tensors.
- Sequences identified based on temporal gaps > 10 minutes to maintain continuity.
- Training and testing sets balanced for sequence lengths and storm events.

---

## Results and Insights

- Different configurations tested on Moving MNIST dataset for parameter tuning.
- Encoder-decoder architecture proved efficient with comparable performance.
- Insightful findings on filter size, learning rates, and model behavior.
- Challenges with scheduled sampling noted; Leaky ReLU impact on loss observed.

---

## Conclusion and Future Directions

- Project provided deep insights into image processing, CNNs, and LSTM architectures.
- Despite LSTM limitations, achieved satisfactory results in storm prediction.
- **Future work:** Explore Convolutional Transformer models for enhanced nowcasting.


